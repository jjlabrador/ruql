<html>
  <head>
    <title>Example quiz</title>
    <style>
div, p {display:inline;}strong.correct {color:rgb(0,255,0);}strong.incorrect {color:rgb(255,0,0);}strong.partial {color:rgb(255,128,0);}    </style>
    <script type="text/javascript" src="http://code.jquery.com/jquery-2.1.0.min.js">
    </script>
<!-[if lt IE 8]>    <script type="text/javascript" src="http://code.jquery.com/jquery-1.11.0.min.js">
    </script>
<![endif]->  </head>
  <body>
    <!-- Seed: 263104396066062978982929094154904578644 -->
    <form id="form">
      <ol class="questions">
        <li id="question-0" class="question fillin ">
          <div class="text">
            <p>
[2 points] The capital of California is               <input type="text" id="qfi1" class="fillin">
              </input>
              <div id="qfi1r">
              </div>
              <br/>
              <br/>
            </p>
          </div>
        </li>
        <li id="question-1" class="question multiplechoice ">
          <div class="text">
            <p>
[1 point] What is the largest US state?              <br/>
              <br/>
            </p>
          </div>
          <ol class="answers">
            <input type="radio" id="qmc2-1" name="qmc2" class="select">
Alaska<br class=qmc2-1br>            </input>
            <div id="qmc2-1r">
            </div>
            <input type="radio" id="qmc2-2" name="qmc2" class="select">
Texas<br class=qmc2-2br>            </input>
            <div id="qmc2-2r">
            </div>
            <input type="radio" id="qmc2-3" name="qmc2" class="select">
Hawaii<br class=qmc2-3br>            </input>
            <div id="qmc2-3r">
            </div>
            <br/>
          </ol>
        </li>
        <li id="question-2" class="question selectmultiple multiple">
          <div class="text">
            <p>
[1 point] Select ALL that apply: Which are American political parties?              <br/>
              <br/>
            </p>
          </div>
          <ol class="answers">
            <input type="checkbox" id="qsm3-1" class="check">
Democrats<br class=qsm3-1br>            </input>
            <div id="qsm3-1r">
            </div>
            <input type="checkbox" id="qsm3-2" class="check">
Republicans<br class=qsm3-2br>            </input>
            <div id="qsm3-2r">
            </div>
            <input type="checkbox" id="qsm3-3" class="check">
Greens<br class=qsm3-3br>            </input>
            <div id="qsm3-3r">
            </div>
            <input type="checkbox" id="qsm3-4" class="check">
Tories<br class=qsm3-4br>            </input>
            <div id="qsm3-4r">
            </div>
            <input type="checkbox" id="qsm3-5" class="check">
Social Democrats<br class=qsm3-5br>            </input>
            <div id="qsm3-5r">
            </div>
            <br/>
          </ol>
        </li>
        <li id="question-3" class="question selectmultiple multiple">
          <div class="text">
            <p>
[1 point] Select ALL that apply: Which are American political parties?              <br/>
              <br/>
            </p>
          </div>
          <ol class="answers">
            <input type="checkbox" id="qsm4-1" class="check">
Democrats<br class=qsm4-1br>            </input>
            <div id="qsm4-1r">
            </div>
            <input type="checkbox" id="qsm4-2" class="check">
Republicans<br class=qsm4-2br>            </input>
            <div id="qsm4-2r">
            </div>
            <input type="checkbox" id="qsm4-3" class="check">
Greens<br class=qsm4-3br>            </input>
            <div id="qsm4-3r">
            </div>
            <input type="checkbox" id="qsm4-4" class="check">
Tories<br class=qsm4-4br>            </input>
            <div id="qsm4-4r">
            </div>
            <input type="checkbox" id="qsm4-5" class="check">
Social Democrats<br class=qsm4-5br>            </input>
            <div id="qsm4-5r">
            </div>
            <br/>
          </ol>
        </li>
        <li id="question-4" class="question truefalse ">
          <div class="text">
            <p>
[1 point] True or False: The week has 7 days.              <br/>
              <br/>
            </p>
          </div>
          <ol class="answers">
            <input type="radio" id="qmc5-1" name="qmc5" class="select">
True<br class=qmc5-1br>            </input>
            <div id="qmc5-1r">
            </div>
            <input type="radio" id="qmc5-2" name="qmc5" class="select">
False<br class=qmc5-2br>            </input>
            <div id="qmc5-2r">
            </div>
            <br/>
          </ol>
        </li>
        <li id="question-5" class="question truefalse ">
          <div class="text">
            <p>
[1 point] True or False: The earth is flat.              <br/>
              <br/>
            </p>
          </div>
          <ol class="answers">
            <input type="radio" id="qmc6-1" name="qmc6" class="select">
True<br class=qmc6-1br>            </input>
            <div id="qmc6-1r">
            </div>
            <input type="radio" id="qmc6-2" name="qmc6" class="select">
False<br class=qmc6-2br>            </input>
            <div id="qmc6-2r">
            </div>
            <br/>
          </ol>
        </li>
      </ol>
      <button type="button" id="btn">
Submit      </button>
      <button type="button" id="reset">
Retry      </button>
    </form>
    <script type="text/javascript">
      data = {"question-0":["the capital of california is ",{"qfi1":["sacramento",true,null]}],"question-1":["what is the largest us state?",{"qmc2-1":["Alaska",true,null],"qmc2-2":["Texas",false,"That's pretty big, but think colder."],"qmc2-3":["Hawaii",false,null]}],"question-2":["which are american political parties?",{"qsm3-1":["Democrats",true,null],"qsm3-2":["Republicans",true,null],"qsm3-3":["Greens",true,"Yes, they're a party!"],"qsm3-4":["Tories",false,"They're British"],"qsm3-5":["Social Democrats",false,null]}],"question-3":["which are american political parties?",{"qsm4-1":["Democrats",true,null],"qsm4-2":["Republicans",true,null],"qsm4-3":["Greens",true,"Yes, they're a party!"],"qsm4-4":["Tories",false,"They're British"],"qsm4-5":["Social Democrats",false,null]}],"question-4":["true or false: the week has 7 days.",{"qmc5-1":["True",true,null],"qmc5-2":["False",false,""]}],"question-5":["true or false: the earth is flat.",{"qmc6-1":["True",false,"No, just looks that way"],"qmc6-2":["False",true,null]}]};
      
      function checkFIQEmpty(textBox) {
        if (textBox == "")
          return true;
        else
          return false;
      }
      
      function checkMCQEmpty(inputs) {
        if (inputs.is(':checked'))
          return false;
        else
          return true;
      }
      
      function checkEmpty() {
        empty = []
        
        for (question in data) {
          q = $("#" + question.toString() + " input");
          if (q.length == 1)
            empty.push(checkFIQEmpty(q.val()));
          else
            empty.push(checkMCQEmpty(q));
        }
        
        if (($.inArray(true, empty)) !== -1)
          return true;
        else
          return false; 
      }
      
      function findCorrectAnswer(idQuestion, questionType) {
        correctIds = [];
        for (id in data[idQuestion][1]) {
          if(data[idQuestion][1][id.toString()][1] == true)
            if (questionType == 0)
              return id.toString();
            else {
              correctIds.push(id.toString());
            } 
        }
        return correctIds;
      }
      
      function checkSelectMultiple(x, checkedIds, correctIds) {
        results = [];
        $.each(checkedIds, function(index, value){
          if (correctIds.indexOf(value) == -1) {
            results.push(false);
            printResults(value, 0, data[x.toString()][1][value][2], "");
          }
          else {
            results.push(true);
            printResults(value, 1, "");
          }
        });
        
        if (($.inArray(false, results)) !== -1)
          return false;
        else
          if (checkedIds.length == correctIds.length)
            return true;
        else {
          printResults(x.toString(), 2, "");
          return false;
        }
      }
      
      function printResults(id, type, explanation) {
        $("br[class=" + id + "br" + "]").detach();
        if (type == 1)
          $("div[id ~= " + id + "r" + "]").html("<strong class=correct> Correct</strong></br>");
        else if (type == 0){
          if ((explanation == "") || (explanation == null))
            $("div[id ~= " + id + "r" + "]").html("<strong class=incorrect> Incorrect</strong></br>");
          else
            $("div[id ~= " + id + "r" + "]").html("<strong class=incorrect> Incorrect - " + explanation + "</strong></br>");
        }
        else {
          $("#" + id).append("<strong class=partial> Partially correct</strong></br></br>");
        }
      }
      
      function checkAnswers() {
        
        for (x in data) {
          answers = $("#" + x.toString() + " input");
          
          if (answers.attr('class') == "fillin") {
            if ($("#" + answers.attr('id')).val().toLowerCase() == data[x.toString()][1][answers.attr('id')][0]) {
              printResults(answers.attr('id'), 1, "");
            }
            else
              printResults(answers.attr('id'), 0, "");
          }
          
          else if (answers.attr('class') == "select") {
            idCorrectAnswer = findCorrectAnswer(x.toString(), 0);
            
            if ($("#" + x.toString() + " :checked").attr('id') == idCorrectAnswer)
              printResults($("#" + x.toString() + " :checked").attr('id'), 1, "");
            else {
              id = $("#" + x.toString() + " :checked").attr('id');
              printResults(id, 0, data[x.toString()][1][id][2]);
            }
          }
          
          else {
            answers = $("#" + x.toString() + " :checked");
            checkedIds = [];
            
            $.each(answers, function(index, value){
              checkedIds.push(value['id']);
            });
            
            correctIds = [];
            correctIds = findCorrectAnswer(x.toString(), 1);
            valid = checkSelectMultiple(x, checkedIds, correctIds);   
          } 
        }
      }
      
      function checkForm() {
        if (!checkEmpty()) {
          checkAnswers();
        }
        else {
          alert('ERROR. Some fields are empty');
        }
      }
      
      $("#btn").click(function() {
        checkForm();
      });
      
      $("#reset").click(function() {
        window.location.reload();
      });
    </script>
  </body>
</html>
